# This file generated by the Chef Infra Server. Any direct modifications
# will be lost on next reconfigure. You can tune elasticsearch
# via elasticsearch.* settings in /opt/opscode/chef-server.rb.
#
<%
# For more information, see configuration documentation at:
# https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-configuration.html
%>
cluster.name: <%= @cluster_name %>
node.name: <%= node['fqdn'] %>
path.data:  <%= @data_dir %>
path.logs: <%= @log_directory %>
# NOTE(ssd) 2020-05-21: This value must be quoted to handle values
# such as ::
network.host: "<%= @listen %>"
# Reference: http://www.elastic.co/guide/en/elasticsearch/reference/current/modules-network.html
#            http://www.elastic.co/guide/en/elasticsearch/reference/current/modules-gateway.html
#            http://www.elastic.co/guide/en/elasticsearch/reference/current/modules-discovery.html
http.port: <%= @port %>

######## Start OpenSearch Security Configuration ########
plugins.security.ssl.transport.pemcert_filepath: node.pem
plugins.security.ssl.transport.pemkey_filepath: node-key.pem
plugins.security.ssl.transport.pemtrustedcas_filepath: root-ca.pem
plugins.security.ssl.transport.enforce_hostname_verification: false
plugins.security.ssl.http.enabled: false
plugins.security.allow_default_init_securityindex: true
plugins.security.authcz.admin_dn:
  - "CN=ADMIN,OU=UNIT,O=ORG,L=TORONTO,ST=ONTARIO,C=CA"

plugins.security.audit.type: internal_opensearch
plugins.security.enable_snapshot_restore_privilege: true
plugins.security.check_snapshot_restore_write_privileges: true
plugins.security.restapi.roles_enabled: ["all_access", "security_rest_api_access"]
plugins.security.system_indices.enabled: true
plugins.security.system_indices.indices: [".opendistro-alerting-config", ".opendistro-alerting-alert*", ".opendistro-anomaly-results*", ".opendistro-anomaly-detector*", ".opendistro-anomaly-checkpoints", ".opendistro-anomaly-detection-state", ".opendistro-reports-*", ".opendistro-notifications-*", ".opendistro-notebooks", ".opendistro-asynchronous-search-response*", ".replication-metadata-store"]
node.max_local_storage_nodes: 3
######## End OpenSearch Security Configuration ########

discovery.type: single-node